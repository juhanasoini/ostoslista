(function(t){function e(e){for(var s,a,o=e[0],l=e[1],c=e[2],d=0,m=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&m.push(i[a][0]),i[a]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(m.length)m.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],s=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(s=!1)}s&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var s={},i={app:0},r=[];function a(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=s,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(n,s,function(e){return t[e]}.bind(null,s));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"2b9d":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("a026"),i=s["default"].component("App",{template:"\n\t\t<router-view></router-view>\n\t"}),r=(n("96cf"),n("1da1")),a=n("8c4f"),o=(n("4160"),n("d3b7"),n("498a"),n("159b"),s["default"].component("loading",{props:["text","wrapper"],template:'<div class="loader-container" v-bind:class="{ curtain: wrapper }"><div class="loader-content"><i class="fas fa-fan fa-spin fa-3x fa-fw"></i> <span>{{text}}</span></div></div>'}),s["default"].component("errors",{props:["error"],template:'<div v-if="error.length" class="error-list alert alert-warning" role="alert"><ul><li v-for="item in error">{{item.message}}</li></ul></div>'}),s["default"].component("success",{template:'<div class="alert alert-success" role="success"><slot name="heading"></slot><slot name="message"></slot><slot name="link"></slot></div>'}),s["default"].component("Login",{data:function(){return{userName:"Julle",password:"passu",errors:[],loading:!1}},methods:{validateForm:function(){return this.errors=[],""!=this.userName.trim()&&""!=this.password.trim()||(""==this.userName.trim()&&this.errors.push({field:"userName",message:"Anna käyttäjänimi"}),""==this.password.trim()&&this.errors.push({field:"password",message:"Anna salasana"}),!1)},submitForm:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,n.loading=!0,e.validateForm())try{fetch("/api/user/login",{method:"POST",body:JSON.stringify({userName:e.userName,password:e.password}),headers:{"Content-Type":"application/json"}}).then((function(t){return 200===t.status&&h.push({name:"index"}),t})).then((function(t){return t.json()})).then((function(t){t.length&&t.forEach((function(t,e){s["default"].set(n.errors,e,{message:t.message})}))})).catch((function(t){console.error(t)}))}catch(i){console.error(i)}n.loading=!1;case 4:case"end":return t.stop()}}),t)})))()}},template:'\n\t\t<div class="d-flex align-items-center justify-content-center" style="height: 100vh">\n        \t<div className="flex-row">\n        \t\t<b-card header="Kirjaudu sisään" header-tag="h3" class="mx-3">\n        \t\t\t<errors v-bind:error=errors />\n        \t\t\t<loading v-if="loading" text="Lataa" v-bind:wrapper=true />\n\t\t\t\t    <b-form inline v-on:submit.prevent="submitForm">\n\t\t\t\t\t    <b-input id="inline-form-input-name" class="mb-2 mr-sm-2 mb-sm-0" placeholder="Käyttäjänimi" v-model="userName"></b-input>\t\t\t\t\t    \n\t\t\t\t\t    <b-input id="inline-form-input-username" placeholder="Salasana" type="password" v-model="password"></b-input>\n\t\t\t\t\t    <b-button variant="primary" type="submit">Kirjaudu</b-button>\n\t\t\t\t  \t</b-form>\n\t\t\t\t  \t<template v-slot:footer>\n\t\t\t\t        Eikö sinulla ole vielä tiliä? Rekisteröidy <router-link :to="{ name: \'register\'}">tästä</router-link>\n\t\t      \t\t</template>\n\t\t  \t\t</b-card>\n        \t</div>\n    \t</div>\n\t'})),l=n("5f5b"),c=(n("caad"),n("45fc"),n("2532"),n("a434"),n("b0c0"),n("25f0"),s["default"].component("shoppinglistListItem",{props:["data","existsID"],data:function(){return{isHidden:!1,informExists:!1}},created:function(){this.$emit("created")},computed:{insertClasses:function(){return{done:this.data.done,hidden:this.isHidden,"list-item":!0,exists:this.informExists}}},watch:{existsID:function(t,e){if(this.informExists=this.data._id==t,this.informExists){var n=this;setTimeout((function(){n.informExists=!1,n.$emit("reset-existingID")}),3e3)}}},methods:{removeItem:function(t){this.$emit("remove-list-item",this.data)},toggleDone:function(t){this.data.done=!this.data.done,this.$emit("item-done"),this.$emit("update-list")}},template:'<li :class="insertClasses">{{data.title}}\n  \t\t\t\t\t<span class="tools">\n  \t\t\t\t\t\t<button v-if="!this.data.done" v-on:click="toggleDone" class="list-item-done-toggle" title="Merkitse valmiiksi"><i class="fas fa-check"></i></button>\n  \t\t\t\t\t\t<button v-else v-on:click="toggleDone" class="list-item-done-toggle" title="Merkitse puuttuvaksi"><i class="fas fa-undo"></i></button>\n  \t\t\t\t\t\t<button v-on:click="removeItem" class="text-warning" title="Poista"><i class="far fa-trash-alt"></i></button>\n  \t\t\t\t\t</span>\n\t\t\t\t</li>'}),n("bc3a")),u=n.n(c);s["default"].component("shoppinglistList",{props:["list","number"],data:function(){return{message:"",edit:!1,prevName:"",nameUpdated:!1,allRemoveDisabled:!0,existsID:null}},created:function(){this.$emit("List-list created")},methods:{add:function(t){var e=this;t.preventDefault();var n=this.message.trim();if(""==n)return!1;var s=function(t){if(t.title.toLowerCase()==n.toLowerCase())return e.existsID=t._id,!0};if(this.list.items.some(s))return this.message="",!1;var i=(new Date).getTime().toString(16),r={id:i,title:n,done:!1};this.message="",this.list.items.push(r),this.updateList(),this.$emit("add-item",r)},removeItem:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="id",s=-1,"undefined"!=typeof e._id&&(n="_id"),this.list.items.some((function(t,i){if(t[n]==e[n])return s=i,!0})),-1==s){t.next=9;break}return this.list.items.splice(s,1),t.next=8,this.updateList().then((function(t){return console.log(t)})).catch((function(t){console.error(t)}));case 8:return t.abrupt("return",!0);case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),toggleRemoveAllDone:function(){this.allRemoveDisabled=!0;var t=function(t){return!0===t.done};this.list.items.some(t)&&(this.allRemoveDisabled=!1)},removeDone:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(this.list.items.forEach((function(t,e){})),e=this.list.items.length-1;e>=0;e--)this.list.items[e].done&&this.list.items.splice(e,1);return t.next=4,this.updateList().then((function(t){return console.log(t)})).catch((function(t){console.error(t)}));case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),toggleEdit:function(t){t.preventDefault(),this.edit=!this.edit,this.edit?this.prevName=this.list.name:this.list.name=this.prevName},removeList:function(t){t.preventDefault(),confirm("Haluatko varmasti poistaa listan: ".concat(this.list.name))&&console.log(this.list)},updateList:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,u.a.put("/api/list/items",e.list);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),updateListName:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,u.a.put("/api/list/name",{_id:this.list._id,name:this.list.name}).then((function(t){return t})).catch((function(t){console.error(t)}));case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()},template:'\n  \t\t<div>\n\t\t  \t<div v-if="!edit" class="card bg-primary text-white">\n\t\t        <div class="card-header">\n\t\t            <template v-if="list">\n\t\t            {{list.name}}<b-button class="ml-2 btn-sm btn-success float-right" v-on:click="toggleEdit" title="Muokkaa listaa"><i class="fas fa-edit"></i></b-button>\n\t\t            </template>\n\t\t        </div>\n\t\t        <div class="card-body">\n\t\t    \t\t<loading v-if="!list" text="Lataillaan" />\n\t\t            <ol class="shoppinglist-list" v-if="list">\n\t\t                <shoppinglistListItem \n\t\t                \tv-for="item in list.items" \n\t\t                \tv-bind:key=item.uniqid \n\t\t                \tv-bind:data=item \n\t\t                \tv-bind:existsID=existsID\n\t\t                \t@remove-list-item="removeItem" \n\t\t                \t@item-done="toggleRemoveAllDone" \n\t\t                \t@update-list="updateList"\n\t\t                \t@reset-existingID="existsID = null"\n\t\t                \tv-on="$listeners" />\n\t\t            </ol>\n\t\t            <button v-on:click="removeDone" class="btn btn-warning btn-sm float-right" v-bind:disabled="allRemoveDisabled" title="Poista valmiit"><i class="fas fa-trash-alt"></i></button>\n\t\t        </div>\n\t\t        <div class="card-footer">\n\t\t        \t<form class="form-inline" v-on:submit.prevent>\n\t\t            \t<input class="form-control" type="text" v-model="message" v-on:keyup.enter="add" placeholder="Lisää listalle" autofocus /><b-button class="ml-2" variant="primary" v-on:click="add"><i class="fas fa-plus-circle"></i></b-button>\n\t\t        \t</form>\n\t\t        </div>\n\t\t    </div>\n\t\t    <div v-if="edit" class="card bg-primary text-white">\n\t\t        <div class="card-header form-inline">\n\t\t            <input class="form-control form-control-sm" type="text" v-model="list.name">\n\t\t            <b-button class="ml-2 btn-sm" variant="success" title="Tallenna nimi" v-on:click="updateListName" v-bind:disabled="prevName == list.name"><i class="fas fa-check"></i></b-button>\n\t\t        </div>\n\t\t        <div class="card-body">\n\t\t        \t<b-button class="ml-2 btn-sm" variant="danger" v-on:click="removeList" title="Sulje muokkaus"><i class="fas fa-trash-alt"></i> Poista lista</b-button>\n\t\t        \t<hr>\n\t\t        \t<h4>Jaa lista</h4>\n\t\t        \t<small class="text-info mb-2 d-block">Voit jakaa listan sellaisen henkilön kanssa joka on myös rekisteröitynyt tähän palveluun</small>\n\t\t        \t<form class="form-inline">\n\t\t        \t\t<input class="form-control form-control-sm" type="email" placeholder="Anna sähköpostiosoite">\n\t\t            \t<b-button class="ml-2 btn-sm" variant="success" title="Jaa lista"><i class="fas fa-share-square" ></i></b-button>\n\t\t            </form>\n\t\t        </div>\n\t\t        <div class="card-footer text-right">\n\t\t        \t<b-button class="ml-2 btn-sm" variant="warning" v-on:click="toggleEdit" title="Sulje muokkaus"><i class="fas fa-undo"></i></b-button>\n\t\t        </div>\n\t\t    </div>\n\t    </div>\n    '});s["default"].component("shoppinglist",{props:{lists:Array},data:function(){return{shoppingLists:[],shoppingList:null,itemList:[]}},watch:{lists:function(t,e){this.shoppingLists=t,this.shoppingList=this.shoppingLists[0]}},created:function(){this.$emit("List created")},methods:{handleItemAdd:function(t){if(this.itemList.includes(t.title))return!1;this.itemList.push(t.title)},chooseList:function(t){var e=this;e.shoppingLists.some((function(n,s){if(n.id==t)return e.shoppingList=e.shoppingLists[s],!0}))}},template:'\n  \t\t<div class="row">\n  \t\t\t<div class="col-sm-12 col-lg-6">\n  \t\t\t\t<shoppinglistList v-bind:list=shoppingList @add-item="handleItemAdd"  />\n\t\t\t</div>\n\t\t\t<div class="d-none d-lg-block col-sm-3">\n\t\t\t\t<b-list-group class="shoppinglist-user-lists">\n\t\t\t\t  <b-list-group-item class="d-flex justify-content-between align-items-center" v-for="(list, index) in shoppingLists" v-bind:key="list.id">\n\t\t\t\t    <a v-on:click="chooseList( list.id )">{{list.name}}</a>\n\t\t\t\t    <b-badge class="ml-3" variant="primary" pill>{{ list.items.length }}</b-badge>\n\t\t\t\t  </b-list-group-item>\n\t\t\t\t</b-list-group>\n\t\t\t</div>\n\t\t</div>'}),n("f9e3"),n("2dd8"),n("2b9d"),n("7f2c");s["default"].use(l["a"]);var d=s["default"].component("shoppinglistapp",{data:function(){return{user:{username:"",email:"",lists:[]}}},created:function(){this.getUserData()},methods:{getUserData:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,u.a.get("/api/user/currentuser").then((function(t){e.user=t.data,s["default"].set(e.user,"lists",t.data.lists),console.log(e.user)})).catch((function(t){console.log(t)}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},template:'\n\t\t<div class="container">\n            <div class="row">\n                <div class="col-sm-12">\n                \t<b-navbar class="mb-1 info-color" toggleable="lg" type="dark">\n                      <b-navbar-brand href="#">Ostoslista<sup>TM</sup></b-navbar-brand>\n                      <b-navbar-toggle target="nav-collapse"></b-navbar-toggle>\n                      <b-collapse id="nav-collapse" is-nav>\n                      \t<b-navbar-nav class="ml-auto">\n\t\t\t\t\t      \t<b-nav-item-dropdown right>\n\t\t\t\t\t      \t\t<template  v-if="user" v-slot:button-content>\n\t\t\t\t\t\t\t\t\t<i class="fas fa-user"></i> {{user.username}}\n\t\t\t\t\t\t\t\t</template>\t\n\t\t\t\t\t\t\t\t<b-dropdown-item href="#">My account</b-dropdown-item>\n\t\t\t\t\t\t\t\t<b-dropdown-item href="/logout">Kirjaudu ulos</b-dropdown-item>\n\t\t\t\t\t        </b-nav-item-dropdown>\n\t\t\t\t      \t</b-navbar-nav>\n                      </b-collapse>\n                    </b-navbar>\n                </div>\n              </div>  \n              \n              <shoppinglist v-bind:lists="user.lists" />\n                \n            </div>\n        </div>\n\t'}),m=(n("b64b"),n("07ac"),s["default"].component("registrationForm",{data:function(){return{username:"",password:"",passwordConf:"",email:"",errors:[],errorFields:[],loading:!1,phase:"register"}},methods:{validateForm:function(){this.errors=[],this.errorFields=[];var t=this.username.trim(),e=this.password.trim(),n=this.passwordConf.trim(),s=this.email.trim();return""==t&&(this.errors.push({message:"Anna käyttäjänimi"}),this.errorFields.push("username")),""==s&&(this.errors.push({message:"Anna Sähköpostiosoite"}),this.errorFields.push("email")),""==e&&(this.errors.push({message:"Anna salasana"}),this.errorFields.push("password")),""==n?(this.errors.push({message:"Anna salasana uudelleen"}),this.errorFields.push("passwordConf")):e!=n&&(this.errors.push({message:"Salasanat eivät täsmää"}),this.errorFields.push("password"),this.errorFields.push("passwordConf")),0==this.errors.length},submitForm:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n,i,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e,n.loading=!0,!e.validateForm()){t.next=22;break}return t.prev=3,t.next=6,fetch("/api/user/register",{method:"POST",body:JSON.stringify({username:e.username,password:e.password,email:e.email}),headers:{"Content-Type":"application/json"}});case 6:if(i=t.sent,400!=i.status){t.next=16;break}return t.next=10,i.json();case 10:r=t.sent,n.errorFields=Object.keys(r),a=Object.values(r),a.forEach((function(t,e){s["default"].set(n.errors,e,{message:t.message})})),t.next=17;break;case 16:e.phase="success";case 17:t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](3),console.error(t.t0);case 22:n.loading=!1;case 23:case"end":return t.stop()}}),t,null,[[3,19]])})))()}},template:'\n\t\t<div class="d-flex align-items-center justify-content-center" style="height: 100vh">\n        \t<div class="flex-row w-50">\n        \t\t<b-card header="Rekisteröidy" header-tag="h3" class="mx-3">\n        \t\t\t<errors v-bind:error=errors />\n        \t\t\t<loading v-if="loading" text="Lataa" v-bind:wrapper=true />\n\t\t\t\t    <b-form v-if="phase === \'register\'" v-on:submit.prevent="submitForm">\n\t\t\t\t    \t<b-form-row class="mb-sm-3"> \n\t\t\t\t    \t\t<div class="col-sm-6">\n\t\t\t\t\t    \t\t<b-input class="mb-2 mr-sm-2 mb-sm-0" v-bind:class="{ \'is-invalid\': errorFields.indexOf( \'username\' ) != -1}" placeholder="Käyttäjänimi*" v-model="username" ></b-input>\n\t\t\t\t    \t\t</div>\n\t\t\t\t    \t\t<div class="col-sm-6">\n\t\t\t\t\t    \t\t<b-input class="mb-2 mr-sm-2 mb-sm-0" v-bind:class="{ \'is-invalid\': errorFields.indexOf( \'email\' ) != -1}" placeholder="Sähköpostiosoite*" v-model="email" type="email" ></b-input>\n\t\t\t\t    \t\t</div>\n\t\t\t\t\t    </b-form-row> \n\t\t\t\t\t    <b-form-row class="mb-3">\n\t\t\t\t    \t\t<div class="col-sm-6">\n\t\t\t\t\t    \t\t<b-input class="mb-2 mr-sm-2 mb-sm-0" v-bind:class="{ \'is-invalid\': errorFields.indexOf( \'password\' ) != -1}" placeholder="Salasana*" type="password" v-model="password" ></b-input>\n\t\t\t\t    \t\t</div>\n\t\t\t\t    \t\t<div class="col-sm-6">\n\t\t\t\t    \t\t\t<b-input class="mb-2 mr-sm-2 mb-sm-0" v-bind:class="{ \'is-invalid\': errorFields.indexOf( \'passwordConf\' ) != -1}" placeholder="Salasana uudelleen*" type="password" v-model="passwordConf" ></b-input>\n\t\t\t    \t\t\t</div>\n\t\t\t\t\t    </b-form-row> \n\t\t\t\t\t    <b-form-row>\n\t\t\t\t    \t\t<div class="col">\n\t\t\t\t\t    \t\t<b-button class="float-right" variant="primary" type="submit">Rekisteröidy</b-button>\n\t\t\t\t\t    \t</div>\n\t\t\t\t    \t</b-form-row>\n\t\t\t\t  \t</b-form>\n\t\t\t\t  \t<success v-if="phase === \'success\'">\n\t\t\t\t  \t\t<template v-slot:message>\n\t\t\t\t\t    \t<h3>Tili luotu</h3><p>Voit nyt kirjautua.</p>\n\t\t\t\t\t  \t</template>\n\t\t\t\t  \t\t<template v-slot:link>\n\t\t\t\t  \t\t\t<b-button href="#" :to="{ name: \'login\'}" variant="info">Kirjautumiseen</b-button>\n\t\t\t\t\t  \t</template>\n\t\t\t\t  \t</success>\n\t\t  \t\t</b-card>\n        \t</div>\n    \t</div>\n\t'})),p={isLoggedIn:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("/api/user/isloggedin");case 2:return e=t.sent,t.abrupt("return",200===e.status||!1);case 4:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}()};s["default"].use(a["a"]);var f=new a["a"]({mode:"history",routes:[{path:"/login",name:"login",component:o},{path:"/register",name:"register",component:m},{path:"/",name:"index",component:d,beforeEnter:function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(e,n,s){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p.isLoggedIn();case 2:i=t.sent,i?s():s({path:"/login"});case 4:case"end":return t.stop()}}),t)})));function e(e,n,s){return t.apply(this,arguments)}return e}()}]}),h=f,v=n("9483");Object(v["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),s["default"].config.productionTip=!1,new s["default"]({router:h,render:function(t){return t(i)}}).$mount("#shoppinglist-app")},"7f2c":function(t,e,n){}});
//# sourceMappingURL=app.1eb8eeb0.js.map